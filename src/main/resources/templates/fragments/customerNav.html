<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<nav class="navbar navbar-expand-lg game-nav shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="/home">
            <img src="/img/logoFinal.png" alt="Logo" class="nav-logo">
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="mainNavbar">
            <ul class="navbar-nav mx-auto align-items-center nav-center">
                <li class="nav-item">
                    <a class="nav-link nav-pill" href="/home">
                        <i class="fa fa-home me-2"></i>Trang Chủ
                    </a>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link nav-pill dropdown-toggle require-login"
                       href="#"
                       data-bs-toggle="dropdown"
                       th:data-logged="${#authorization.expression('isAuthenticated()')}">
                        <i class="fa fa-list me-2"></i>Tài khoản vĩnh viễn
                    </a>
                    <ul class="dropdown-menu dropdown-soft">
                        <li>
                            <a class="dropdown-item require-login"
                               th:href="@{/home/listAcc(game='AOV')}"
                               th:data-logged="${#authorization.expression('isAuthenticated()')}">
                                AOV
                            </a>
                        </li>
                        <li>
                            <a class="dropdown-item require-login"
                               th:href="@{/home/listAcc(game='FREE FIRE')}"
                               th:data-logged="${#authorization.expression('isAuthenticated()')}">
                                Free Fire
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link nav-pill require-login"
                               th:href="@{/home/pendingOrders}"
                               th:data-logged="${#authorization.expression('isAuthenticated()')}">
                                <i class="fa fa-clock me-2"></i>Đơn hàng đang chờ
                            </a>
                        </li>

                    </ul>
                </li>

                <li class="nav-item">
                    <a class="nav-link nav-pill require-login"
                       th:href="@{/home/renting}"
                       th:data-logged="${#authorization.expression('isAuthenticated()')}">
                        <i class="fa fa-user-circle me-2"></i>Tài khoản đang thuê
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link nav-pill require-login"
                       th:href="@{/home/transaction}"
                       th:data-logged="${#authorization.expression('isAuthenticated()')}">
                        <i class="fa fa-credit-card me-2"></i>Ví
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link nav-pill require-login"
                       th:href="@{/home/cart}"
                       th:data-logged="${#authorization.expression('isAuthenticated()')}">
                        <i class="fa fa-coins me-2"></i>Giỏ Hàng
                    </a>
                </li>
            </ul>

            <ul class="navbar-nav ms-lg-3 align-items-center nav-user">
                <li class="nav-item dropdown" sec:authorize="isAnonymous()">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" data-bs-toggle="dropdown">
                        <img src="/img/guest.png" class="rounded-circle me-2" style="width:35px;">
                        <span class="fw-semibold">Khách</span>
                    </a>
                    <ul class="dropdown-menu dropdown-fix">
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Đăng nhập</a></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Đăng ký</a></li>
                    </ul>
                </li>

                <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                    <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" data-bs-toggle="dropdown">
                        <img src="/img/customer.png" class="rounded-circle me-2" style="width:35px;">
                        <span class="fw-semibold" th:text="${#authentication.name}"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-fix">
                        <li>
                            <a class="dropdown-item"
                               th:href="@{/home/profile/{id}(id=${currentUser != null ? currentUser.customerId : ''})}">
                                Thông tin tài khoản
                            </a>
                        </li>
                        <li>
                            <form th:action="@{/logout}" method="post">
                                <button class="dropdown-item" type="submit">Đăng xuất</button>
                            </form>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <style>
        .game-nav{background:pink;border-top:2px solid #e6d8c8;height:86px;display:flex;align-items:center}
        .game-nav .container-fluid{display:flex;align-items:center}
        .nav-logo{height:180px;width:auto}
        .nav-center{gap:26px}
        .game-nav .navbar-nav .nav-link{color:#111!important;font-weight:500}
        .nav-pill{background:transparent;color:#000!important;border:1px solid transparent;transition:background .15s ease,box-shadow .15s ease,transform .15s ease}
        .nav-pill:hover{color:#f7931e!important;background:#F8F8FF;box-shadow:none!important;transform:none!important}
        .nav-pill:focus,.nav-pill:active{background:#f5e6d7!important;color:#000!important;box-shadow:none!important}
        .dropdown-soft{border-radius:14px;padding:6px}
        .nav-pill{border-radius:18px!important;padding:10px 18px!important}
        .nav-pill:hover{border-radius:18px!important;box-shadow:0 6px 18px rgba(0,0,0,.08)!important}
        .nav-pill:focus,.nav-pill:active{border-radius:18px!important;box-shadow:0 6px 18px rgba(0,0,0,.08)!important}
    </style>
</nav>

<div id="loginAlert" class="alert alert-warning text-center fw-semibold d-none" style="position:fixed;top:80px;left:50%;transform:translateX(-50%);z-index:9999;">
    ⚠️ Vui lòng đăng nhập để sử dụng chức năng này
</div>

<script>
    document.querySelectorAll('.require-login').forEach(link => {
        link.addEventListener('click', function (e) {
            const isLogged = this.dataset.logged === 'true';
            if (!isLogged) {
                e.preventDefault();
                showLoginAlert();
            }
        });
    });
    function showLoginAlert() {
        const alertBox = document.getElementById('loginAlert');
        alertBox.classList.remove('d-none');
        setTimeout(() => {
            alertBox.classList.add('d-none');
        }, 3000);
    }
</script>
</body>
</html>